!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).cm={})}(this,(function(t){"use strict";const n=Object.getPrototypeOf,e={},o=new Set(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"]),r=t=>t instanceof SVGElement,s=t=>{return o.has(t)||((n=t).startsWith("on")||n.startsWith("style"))?t:t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));var n};function i(t,o,r){if(o.startsWith("on"))return t.addEventListener(o.slice(2).toLowerCase(),r);if(o.startsWith("style"))return t.style.setProperty((s=o.slice(5)).charAt(0).toLowerCase()+s.slice(1),r);var s;const i=t.tagName.toLowerCase(),c=t=>t?Object.getOwnPropertyDescriptor(t,o)??c(n(t)):void 0,a=i+","+o,u=e[a]??=c(n(t))?.set??0;(u?u.bind(t):t.setAttribute.bind(t,o))(r)}function c(t,n){const e=[t].flat(1/0);for(let t=0;t<e.length;t++){const o=e[t],c=r(o)?s:t=>t;for(const r in n){const s=n[r],a=c(r),u=!a.startsWith("on")&&"function"==typeof s;i(o,a,u?s(o,t,e):s)}}}var a,u,l=0,f=0,h=0,d=0,v=0,p=0,y="object"==typeof performance&&performance.now?performance:Date,m="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function x(){return v||(m(g),v=y.now()+p)}function g(){v=0}function w(){this._call=this._time=this._next=null}function _(){v=(d=y.now())+p,l=f=0;try{!function(){x(),++l;for(var t,n=a;n;)(t=v-n._time)>=0&&n._call.call(void 0,t),n=n._next;--l}()}finally{l=0,function(){var t,n,e=a,o=1/0;for(;e;)e._call?(o>e._time&&(o=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:a=n);u=t,M(o)}(),v=0}}function b(){var t=y.now(),n=t-d;n>1e3&&(p-=n,d=t)}function M(t){l||(f&&(f=clearTimeout(f)),t-v>24?(t<1/0&&(f=setTimeout(_,t-y.now()-p)),h&&(h=clearInterval(h))):(h||(d=y.now(),h=setInterval(b,1e3)),l=1,m(_)))}function C(t,{frameRate:n}={}){let e=0;const o=function(t,n,e){var o=new w,r=n;return null==n?(o.restart(t,n,e),o):(o._restart=o.restart,o.restart=function(t,n,e){n=+n,e=null==e?x():+e,o._restart((function s(i){i+=r,o._restart(s,r+=n,e),t(i)}),n,e)},o.restart(t,n,e),o)}((n=>t({elapsed:n,frameCount:++e})),n?1e3/n:void 0);return()=>o.stop()}w.prototype={constructor:w,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?x():+e)+(null==n?0:+n),this._next||u===this||(u?u._next=this:a=this,u=this),this._call=t,this._time=e,M()},stop:function(){this._call&&(this._call=null,this._time=1/0,M())}};class A{constructor(){this._disposers=[]}on(t,n,e={}){const o="animate"===t?C(n,e):function(t,n,e={}){return"boolean"==typeof e&&(e={capture:e}),window.addEventListener(t,n,e),()=>window.removeEventListener(t,n,e)}(t,n,e);return this._disposers.push(o),this}dispose(){this._disposers.forEach((t=>t())),this._disposers=[]}}const T=t=>"function"==typeof t;function E(t,n,e){const o=[];for(const t of e){const n=t._svg,e=t._tag,r=t._data,s=t._options,i=t._children;for(let t=0;t<r.length;t++){const a=r[t],u=n?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e),{decorators:l=[],...f}=s,h={};for(const[n,e]of Object.entries(f))n.startsWith("on")?h[n]=n=>e(n,a,t,r):h[n]=T(e)?e(a,t,r):e;const d=i.flatMap((n=>T(n)?n(a,t,r):n));c(u,h);for(const n of l){const{type:e,...o}=T(n)?n(a,t,r):n;e(u,o)}o.push(u),E(u,null,d)}}t.replaceChildren(...o)}const L={current:null};class S{constructor(t,n,e,o,r){this._svg=t,this._tag=n,this._data=e,this._options=o,this._nodes=[],this._children=r}}const j=(t,n,e,o)=>{void 0===o&&(o=e,e=[0]);const{children:r=[],...s}=o;return new S(t,n,e,s,r)},k=t=>{const n=["then","next","return"];return new Proxy(Object.create(null),{get:(e,o)=>{if(!n.includes(o))return(n,e)=>t(o,n,e)}})},O=k(j.bind(null,!0)),P=k(j.bind(null,!1));let X;function Y(t){return function(...n){const e=new Et;return t(e,...n),e}}function U(t){return function(...n){return t(this,this,...n),this}}function q(t,n,e){t.x=n.x+e.x,t.y=n.y+e.y}const D=U(q),N=Y(q);function W(t,n,e){t.x=n.x-e.x,t.y=n.y-e.y}const R=U(W),F=Y(W);function I(t,n){return Math.sqrt(V(t,n))}function V(t,n){const e=t.x-n.x,o=t.y-n.y;return e*e+o*o}function G(t,n,e){t.x=n.x*e,t.y=n.y*e}const H=U(G),Z=Y(G);function z(t,n,e){if(0!==e){const o=n/e;t.mult(o)}}function B(t,n,e){t.x=n.x/e,t.y=n.y/e}const J=U(B),K=Y(B);function Q(t,n){const e=n.mag();0!==e&&t.set(n).div(e)}const $=U(Q),tt=Y(Q);function nt(t,n,e,o){const[r,s]=3===arguments.length?[0,e]:[e,o],i=t.set(n).mag();i<r&&t.mag(r),i>s&&t.mag(s)}function et(t,n,e,o){const[r,s]=3===arguments.length?[0,e]:[e,o],i=Math.max(r,Math.min(s,n.x));t.x=i,t.y=n.y}function ot(t,n,e,o){const[r,s]=3===arguments.length?[0,e]:[e,o],i=Math.max(r,Math.min(s,n.y));t.x=n.x,t.y=i}const rt=U(et),st=U(ot),it=U(nt),ct=Y(et),at=Y(ot),ut=Y(nt);function lt(t){t.x=Math.random(),t.y=Math.random()}const ft=U(lt),ht=Y(lt);function dt(t,n){return t.x*n.x+t.y*n.y}function vt(t,n){return t.x*n.y-t.y*n.x}function pt(t,n){t.x=-1*n.x,t.y=-1*n.y}function yt(t,n){t.x=-1*n.x,t.y=n.y}function mt(t,n){t.x=n.x,t.y=-1*n.y}const xt=U(pt),gt=U(yt),wt=U(mt),_t=Y(pt),bt=Y(yt),Mt=Y(mt);function Ct(t,n){const[e,o]=1==arguments.length?[0,t]:[t,n];return this.x>=e&&this.x<=o}function At(t,n){const[e,o]=1==arguments.length?[0,t]:[t,n];return this.y>=e&&this.y<=o}function Tt(){return Math.atan2(this.y,this.x)}function Et(t=0,n=0){Object.defineProperties(this,{x:{value:t,writable:!0},y:{value:n,writable:!0}})}Object.defineProperties(Et.prototype,{set:{value:function(t,n){return t instanceof Et?(this.x=t.x,this.y=t.y,this):(this.x=t,this.y=n,this)}},setX:{value:function(t){return this.x=t,this}},setY:{value:function(t){return this.y=t,this}},add:{value:D},sub:{value:R},dist:{value:function(t){return I(this,t)}},dist2:{value:function(t){return V(this,t)}},mult:{value:H},div:{value:J},mag:{value:function(t){const n=Math.sqrt(this.x*this.x+this.y*this.y);return 0===arguments.length?n:(z(this,t,n),this)}},norm:{value:$},clamp:{value:it},clampX:{value:rt},clampY:{value:st},random:{value:ft},dot:{value:function(t){return dt(this,t)}},cross:{value:function(t){return vt(this,t)}},out:{value:function(t){return t.x=this.x,t.y=this.y,this}},outX:{value:function(t){return t.x=this.x,this}},outY:{value:function(t){return t.y=this.y,this}},neg:{value:xt},negX:{value:gt},negY:{value:wt},inX:{value:Ct},inY:{value:At},angle:{value:Tt},clone:{value:function(){return new Et(this.x,this.y)}}}),t.HTML=P,t.SVG=O,t.constrain=function(t,n,e){return t<n?n:t>e?e:t},t.render=function(t){const{draw:n,loop:e=!1,frameRate:o,...r}=t,s=new A,i={},a={};for(const[t,n]of Object.entries(r))t.startsWith("on")?a[t]=n:i[t]=n;for(const t in a)s.on(t.slice(2).toLowerCase(),a[t]);const u=document.createElementNS("http://www.w3.org/2000/svg","svg");c(u,i);let l=null;const f=t=>{const e=n(t);E(u,0,e),l=e};return e?s.on("animate",(t=>f(t)),{frameRate:o}):(L.current=f,f({}),L.current=null),{dispose:()=>s.dispose(),node:()=>u}},t.state=function(t){const n=new Map;for(const e in t)n.set(e,new Set);return new Proxy(t,{get:(e,o)=>(L.current&&o in t&&n.get(o).add(L.current),e[o]),set(t,e,o){var r;return n.has(e)&&(r=n.get(e),X?X.add(r):(X=new Set([r]),setTimeout((()=>{X.forEach((t=>t.forEach((t=>t())))),X=null})))),t[e]=o,!0}})},t.vec=function(...t){return new Et(...t)},t.vecAdd=N,t.vecAngle=function(t){return Tt.call(t)},t.vecClamp=ut,t.vecClampX=ct,t.vecClampY=at,t.vecCross=vt,t.vecDist=I,t.vecDist2=V,t.vecDiv=K,t.vecDot=dt,t.vecFromAngle=function(t){return new Et(Math.cos(t),Math.sin(t))},t.vecInX=function(...t){return Ct.call(...t)},t.vecInY=function(...t){return At.call(...t)},t.vecMag=function(t,n){const e=Math.sqrt(t.x*t.x+t.y*t.y);if(1===arguments.length)return e;const o=(new Et).set(t);return z(o,n,e),o},t.vecMult=Z,t.vecNeg=_t,t.vecNegX=bt,t.vecNegY=Mt,t.vecNorm=tt,t.vecRandom=ht,t.vecSub=F}));
